<div class="product-list-container">
  <!-- CabeÃ§alho -->
  <div class="header">
    <h1>CatÃ¡logo de Produtos</h1>
  </div>

  <!-- SeÃ§Ã£o de Busca -->
  <div class="search-section">
    <!-- Busca por termo -->
    <div class="search-group">
      <label>Buscar por nome:</label>
      <div class="search-controls">
        <input
          type="text"
          [(ngModel)]="searchTerm"
          (input)="onSearchChange()"
          placeholder="Digite o nome do produto..."
          class="search-input"
        />
        <button
          *ngIf="searchTerm"
          (click)="searchTerm = ''; loadProducts()"
          class="clear-btn">
          âœ•
        </button>
      </div>
    </div>

    <!-- Busca por ID -->
    <div class="search-group">
      <label>Buscar por ID:</label>
      <div class="search-controls">
        <input
          type="text"
          [(ngModel)]="searchById"
          placeholder="Digite o ID do produto..."
          class="search-input"
          (keyup.enter)="searchProductById()"
        />
        <button
          (click)="searchProductById()"
          [disabled]="isSearchingById || !searchById.trim()"
          class="search-btn">
          {{ isSearchingById ? 'Buscando...' : 'Buscar' }}
        </button>
      </div>
    </div>

    <!-- BotÃ£o para limpar todas as buscas -->
    <button
      *ngIf="searchTerm || searchById"
      (click)="clearSearch()"
      class="clear-all-btn">
      Limpar Filtros
    </button>
  </div>

  <!-- Controles de PaginaÃ§Ã£o e OrdenaÃ§Ã£o -->
  <div class="controls-section" *ngIf="!searchTerm && !searchById">
    <div class="controls-row">
      <!-- OrdenaÃ§Ã£o -->
      <div class="sort-controls">
        <label>Ordenar por:</label>
        <select [(ngModel)]="sortField" (change)="changeSortField()" class="select-input">
          <option *ngFor="let option of sortOptions" [value]="option.value">
            {{ option.label }}
          </option>
        </select>
        <button (click)="changeSortDirection()" class="sort-direction-btn">
          {{ sortDirection === 'asc' ? 'â†‘' : 'â†“' }}
        </button>
      </div>

      <!-- Items por pÃ¡gina -->
      <div class="items-per-page">
        <label>Itens por pÃ¡gina:</label>
        <select [(ngModel)]="itemsPerPage" (change)="changeItemsPerPage()" class="select-input">
          <option *ngFor="let option of itemsPerPageOptions" [value]="option">
            {{ option }}
          </option>
        </select>
      </div>
    </div>

    <!-- InformaÃ§Ãµes de paginaÃ§Ã£o -->
    <div class="pagination-info" *ngIf="totalItems > 0">
      <span>
        Mostrando {{ (currentPage - 1) * itemsPerPage + 1 }} a
        {{ Math.min(currentPage * itemsPerPage, totalItems) }} de
        {{ totalItems }} produtos
      </span>
    </div>
  </div>

  <!-- Loading -->
  <div class="loading" *ngIf="isLoading || isSearching || isSearchingById">
    <p>
      {{ isLoading ? 'Carregando produtos...' :
         isSearching ? 'Pesquisando por nome...' :
         'Pesquisando por ID...' }}
    </p>
  </div>

  <!-- Grid de Produtos -->
  <div class="products-grid" *ngIf="!isLoading && !isSearching && !isSearchingById && products.length > 0">
    <div
      class="product-card"
      *ngFor="let product of products"
      (click)="viewProduct(product)">

      <div class="product-image">
        <img
          *ngIf="product.imageUrl"
          [src]="product.imageUrl"
          [alt]="product.name"
          class="product-img"
          (error)="$event.target.style.display='none'"
        />
        <span
          *ngIf="!product.imageUrl"
          class="image-placeholder">
          ðŸ“¦
        </span>
      </div>

      <div class="product-info">
        <h3 class="product-name">{{ product.name }}</h3>
        <p class="product-price">{{ formatPrice(product.price) }}</p>
      </div>
    </div>
  </div>

  <!-- Mensagem quando nÃ£o hÃ¡ produtos -->
  <div class="no-products" *ngIf="!isLoading && !isSearching && !isSearchingById && products.length === 0">
    <p>Nenhum produto encontrado.</p>
  </div>

  <!-- PaginaÃ§Ã£o -->
  <div class="pagination" *ngIf="!isLoading && !isSearching && !isSearchingById && !searchTerm && !searchById && totalPages > 1">
    <button
      (click)="previousPage()"
      [disabled]="currentPage === 1"
      class="pagination-btn">
      Â« Anterior
    </button>

    <div class="page-numbers">
      <button
        *ngFor="let i of getPageNumbers()"
        (click)="goToPage(i)"
        [class.active]="currentPage === i"
        class="page-btn">
        {{ i }}
      </button>
    </div>

    <button
      (click)="nextPage()"
      [disabled]="currentPage === totalPages"
      class="pagination-btn">
      PrÃ³xima Â»
    </button>
  </div>
</div>